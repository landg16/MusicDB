class About{static page(){fetchPage("./template/about.html",(function(e){document.getElementById("page").innerHTML=e}))}}class Albums{static page(){function e(e){let n=document.getElementById("blur"),a=document.querySelector("#item"),r=document.getElementById("list");n.classList.add("show"),getData("./data/albums.json",(function(o){o=o.data,shuffleArray(o),e&&(o=o.filter((t=>String(t.artist_name).toLowerCase().includes(e.toLowerCase())||String(t.album_name).toLowerCase().includes(e.toLowerCase()))));let l=o.length,s=document.createElement("div");let i=16;l<16&&(i=l);for(let e=0;e<i;e++)s.appendChild(t(a,o[e]));const d=document.getElementById("loadMore");d.removeEventListener("clicl",(function(){})),d.addEventListener("click",(function(){s=document.createElement("div");let e=0;e=l-i-16>0?16:l-i,console.log(o);for(let n=i;n<i+e;n++)s.appendChild(t(a,o[n]));i+=e,r.innerHTML+=s.innerHTML,lazyLoadImages(),l-i==0&&(this.style.display="none")})),i>=l&&(d.style.display="none"),r.innerHTML="",0==o.length?r.innerHTML="<div class='col-12 not-found'>Sorry, we could not find your desired artist :(</div>":r.innerHTML=s.innerHTML,n.classList.remove("show")})).then((()=>{lazyLoadImages()}))}function t(e,t){let n=e.content.cloneNode(!0);return n.querySelector(".item-parent").href="#/albums/"+t.id,n.querySelector(".lazy").dataset.src="img/albums/"+t.img,n.querySelector("h4").style.marginBottom="10px",n.querySelector("h4").textContent=t.album_name,n.querySelector("p").textContent=t.artist_name,n}fetchPage("./template/list.html",(function(t){document.getElementById("page").innerHTML=t,document.getElementById("listTitle").innerHTML="All Albums",document.getElementById("sort").style.display="none",e(),function(){const t=document.getElementById("searchInput");document.getElementById("searchBtn").addEventListener("click",(function(){e(t.value)}))}()}))}static detailed(e){function t(e,t,n,a,r){let o=document.querySelector("#track").content.cloneNode(!0);o.getElementById("id").textContent=e,o.getElementById("track_name").textContent=t,o.getElementById("album_name").textContent=n,o.getElementById("artist_name").textContent=a,o.querySelector("tr").onclick=function(){window.location="#/tracks/"+e},document.getElementById(r).appendChild(o)}fetchPage("./template/album.html",(function(n){document.getElementById("page").innerHTML=n,getData("./data/albums.json",(function(n){n=(n=n.data.filter((t=>t.id==e)))[0],document.getElementById("title").innerHTML=n.album_name+" by "+n.artist_name,document.getElementById("image").src="/img/albums/"+n.img,getData("./data/tracks.json",(function(n){n=n.data.filter((t=>t.album_id==e)),shuffleArray(n);for(let e=0;e<n.length;e++)t(n[e].id,n[e].track_name,n[e].album_name,n[e].artist_name,"list")}))}))}))}}class Artists{static page(){function e(e,n){let a=document.getElementById("blur"),r=document.querySelector("#item"),o=document.getElementById("list");a.classList.add("show"),getData("./data/artists.json",(function(l){l=l.data,e?"name"==e?l.sort(sortByName):l.sort(sortByYear):shuffleArray(l),n&&(l=l.filter((e=>String(e.name).toLowerCase().includes(n.toLowerCase())||String(e.year).toLowerCase().includes(n.toLowerCase()))));let s=document.createElement("div");for(let e=0;e<l.length;e++)s.appendChild(t(r,l[e]));o.innerHTML="",0==l.length?o.innerHTML="<div class='col-12 not-found'>Sorry, we could not find your desired artist :(</div>":o.innerHTML=s.innerHTML,a.classList.remove("show")})).then((()=>{lazyLoadImages()}))}function t(e,t){let n=e.content.cloneNode(!0);return n.querySelector(".item-parent").href="#/artists/"+t.id,n.querySelector(".lazy").dataset.src="img/artists/"+t.img,n.querySelector("h4").style.marginBottom="10px",n.querySelector("h4").textContent=t.name,n.querySelector("p").textContent=t.year,n}fetchPage("./template/list.html",(function(t){document.getElementById("page").innerHTML=t,document.getElementById("listTitle").innerHTML="All Artists",document.getElementById("loadMore").style.display="none",e(),document.getElementById("sortArtists").onchange=function(){e(this.value)},function(){const t=document.getElementById("searchInput");document.getElementById("searchBtn").addEventListener("click",(function(){e(null,t.value)}))}()}))}static detailed(e){function t(e,t,n,a,r){let o=document.querySelector("#track").content.cloneNode(!0);o.querySelector(".img").dataset.src=t,o.querySelector("h4").textContent=n,o.querySelector("p").textContent=a,o.querySelector("a").href=e,document.getElementsByClassName(r)[0].appendChild(o)}fetchPage("./template/artist.html",(function(n){document.getElementById("page").innerHTML=n,getData("./data/artists.json",(function(n){n=(n=n.data.filter((t=>t.id==e)))[0],document.getElementById("title").innerHTML=n.name,document.getElementById("name").innerHTML="Name: "+n.name,document.getElementById("year").innerHTML="Year Born: "+n.year,document.getElementById("description").innerHTML=n.description,document.getElementById("image").src="/img/artists/"+n.img,getData("./data/tracks.json",(function(n){n=n.data.filter((t=>t.artist_id==e)),document.getElementById("tracks").innerHTML="Total Tracks: "+(n.length+1),shuffleArray(n);for(let e=0;e<n.length;e++)t("#/tracks/"+n[e].id,"/img/albums/"+n[e].img,n[e].track_name,n[e].album_name,"list")})).then((()=>{lazyLoadImages()})),getData("./data/albums.json",(function(e){console.log(e,n.name),e=e.data.filter((e=>e.artist_name==n.name)),shuffleArray(e);for(let n=0;n<e.length;n++)t("#/albums/"+e[n].id,"/img/albums/"+e[n].img,e[n].album_name,e[n].artist_name,"album")}))}))}))}}let lazyLoadImages=()=>{var e=[].slice.call(document.querySelectorAll(".lazy"));if("IntersectionObserver"in window){let t=new IntersectionObserver((function(e,n){e.forEach((function(e){if(e.isIntersecting){let n=e.target;loadSprite(n),t.unobserve(n)}}))}));e.forEach((function(e){t.observe(e)}))}else console.log("Your browser does not suppor Intersection Observer :(")},loadSprite=e=>{var t=new Image;t.onload=function(){e.style.cssText="background-image: url('"+e.dataset.src+"');",e.classList.remove("lazy")},t.src=e.dataset.src},getWidth=()=>parseFloat(getComputedStyle(document.body,null).width.replace("px","")),slider=e=>{const t=document.getElementById(e),n=t.getElementsByClassName("slide");let a=getWidth()<768?1:4,r=0;addHide(n,r,a),window.addEventListener("resize",(function(){a=getWidth()<768?1:4,addHide(n,r,a)}));const o=t.getElementsByClassName("next")[0],l=t.getElementsByClassName("prev")[0];o.onclick=function(){r+a!=n.length&&(r++,addHide(n,r,a))},l.onclick=function(){r-1<0||(r--,addHide(n,r,a))}},addHide=(e,t,n)=>{for(let a=0;a<e.length;a++)a<t||a>=t+n?e[a].classList.add("hide"):e[a].classList.remove("hide")},fetchPage=(e,t)=>{fetch(e).then((e=>e.text())).then((e=>{t(e)}))},getData=(e,t)=>new Promise(((n,a)=>{var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4===r.readyState&&200===r.status){var e=JSON.parse(r.responseText);return t?(t(e),n()):a()}},r.open("GET",e),r.send()})),shuffleArray=e=>{for(var t=e.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),a=e[t];e[t]=e[n],e[n]=a}},sortByName=(e,t)=>{const n=e.name.toUpperCase(),a=t.name.toUpperCase();return n<a?-1:n>a?1:0},sortByYear=(e,t)=>t.year-e.year;export{lazyLoadImages,slider,fetchPage,getData,shuffleArray,sortByName,sortByYear};class Index{static page(){fetchPage("./template/index.html",(function(e){function t(e,t,n,a,r){let o=document.querySelector("#slide").content.cloneNode(!0);o.querySelector("a").href=r,o.querySelector(".img").dataset.src=t,o.querySelector("h4").textContent=n,o.querySelector("p").textContent=a,document.getElementById(e).getElementsByClassName("carousel-row")[0].appendChild(o)}document.getElementById("page").innerHTML=e,getData("./data/artists.json",(function(e){e=e.data,shuffleArray(e);for(let n=0;n<10;n++)t("featuredArtists","img/artists/"+e[n].img,e[n].name,e[n].year,"#/artists/"+e[n].id)})).then((()=>{lazyLoadImages()})),slider("featuredArtists"),getData("./data/albums.json",(function(e){e=e.data,shuffleArray(e);for(let n=0;n<10;n++)t("featuredAlbums","img/albums/"+e[n].img,e[n].album_name,e[n].artist_name,"#/albums/"+e[n].id)})).then((()=>{lazyLoadImages()})),slider("featuredAlbums"),getData("./data/tracks.json",(function(e){e=e.data,shuffleArray(e);for(let n=0;n<10;n++)t("featuredTracks","img/albums/"+e[n].img,e[n].track_name,e[n].artist_name+" - "+e[n].album_name,"#/tracks/"+e[n].id)})).then((()=>{lazyLoadImages()})),slider("featuredTracks"),getData("https://api.kanye.rest/",(function(e){document.getElementsByClassName("subtitle")[0].textContent=e.quote+" - Kanye West"}))}))}}class Router{routeHistory=[];root="/";constructor(e){e.root&&(this.root=e.root),this.listener()}add=(e,t)=>(this.routeHistory.push({path:e,cb:t}),this);remove=e=>{for(var t=0;t<this.routeHistory.length;t++)if(this.routeHistory[t].path==e)return this.routeHistory.slice(t,1),this;return this};reset=()=>(this.routeHistory=[],this);removeSlashes=e=>e.toString().replace(/\/$/,"").replace(/^\//,"");getView=()=>{var e;const t=window.location.href.match(/#(.*)$/);return e=t?t[1]:"",this.removeSlashes(e)};navigate=()=>(window.location.href=`${window.location.href.replace(/#(.*)$/,"")}`,this);listener=()=>{clearInterval(this.interval),this.interval=setInterval(this.interval,50)};interval=()=>{this.current!=this.getView()&&(this.current=this.getView(),this.routeHistory.some((e=>{const t=this.current.match(e.path);return!!t&&(t.shift(),e.cb.apply({},t),t)})))}}export default Router;class Tracks{static page(){function e(e){let n=document.getElementById("blur"),a=document.querySelector("#item"),r=document.getElementById("list");n.classList.add("show"),getData("./data/tracks.json",(function(o){o=o.data,shuffleArray(o),e&&(o=o.filter((t=>String(t.artist_name).toLowerCase().includes(e.toLowerCase())||String(t.track_name).toLowerCase().includes(e.toLowerCase()))));let l=o.length,s=document.createElement("div");let i=16;l<16&&(i=l);for(let e=0;e<i;e++)s.appendChild(t(a,o[e]));const d=document.getElementById("loadMore");d.removeEventListener("clicl",(function(){})),d.addEventListener("click",(function(){s=document.createElement("div");let e=0;e=l-i-16>0?16:l-i,console.log(o);for(let n=i;n<i+e;n++)s.appendChild(t(a,o[n]));i+=e,r.innerHTML+=s.innerHTML,lazyLoadImages(),l-i==0&&(this.style.display="none")})),console.log("pagination",i),console.log("dataLength",l),i>=l&&(d.style.display="none"),r.innerHTML="",0==o.length?r.innerHTML="<div class='col-12 not-found'>Sorry, we could not find your desired artist :(</div>":r.innerHTML=s.innerHTML,n.classList.remove("show")})).then((()=>{lazyLoadImages()}))}function t(e,t){let n=e.content.cloneNode(!0);return n.querySelector(".item-parent").href="#/tracks/"+t.id,n.querySelector(".lazy").dataset.src="img/albums/"+t.img,n.querySelector("h4").style.marginBottom="10px",n.querySelector("h4").textContent=t.track_name,n.querySelector("p").textContent=t.artist_name,n}fetchPage("./template/list.html",(function(t){document.getElementById("page").innerHTML=t,document.getElementById("listTitle").innerHTML="All Tracks",document.getElementById("sort").style.display="none",e(),function(){const t=document.getElementById("searchInput");document.getElementById("searchBtn").addEventListener("click",(function(){e(t.value)}))}()}))}static detailed(e){function t(e,t,n,a,r){let o=document.querySelector("#track").content.cloneNode(!0);o.querySelector(".img").dataset.src=t,o.querySelector("h4").textContent=n,o.querySelector("p").textContent=a,o.querySelector("a").href=e,document.getElementsByClassName(r)[0].appendChild(o)}fetchPage("./template/track.html",(function(n){document.getElementById("page").innerHTML=n,getData("./data/tracks.json",(function(n){let a=n.data.filter((t=>t.id==e));a=a[0];let r=n.data.filter((e=>e.album_id==a.album_id&&e.id!=a.id));shuffleArray(r);for(let e=0;e<r.length;e++)t("#/tracks/"+r[e].id,"/img/albums/"+r[e].img,r[e].track_name,r[e].artist_name,"list");a.lyrics=a.lyrics.replaceAll("\n","<br />").replace("...",""),document.getElementById("title").innerHTML=a.track_name+" by "+a.artist_name,document.getElementById("album").innerHTML=a.album_name,document.getElementById("image").src="/img/albums/"+a.img,document.getElementById("lyrics").innerHTML=a.lyrics})).then((()=>{lazyLoadImages()}))}))}}const router=new Router({root:"/"});router.add(/tracks\/(.*)/,Tracks.detailed).add(/tracks/,Tracks.page).add(/albums\/(.*)/,Albums.detailed).add(/albums/,Albums.page).add(/artists\/(.*)/,Artists.detailed).add(/artists/,Artists.page).add(/about/,About.page).add("",Index.page),window.onload=function(){const e=document.getElementsByClassName("nav-link");for(let t=0;t<e.length;t++)e[t].onclick=function(){document.getElementById("nav-check").checked=!1}};
